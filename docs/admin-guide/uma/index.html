<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>6. UMA - Gluu Docs</title>
      
<link href="../../assets/stylesheets/font.css" rel="stylesheet">
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Gluu Docs">
    <meta property="og:image" content="None/../../gluu.jpg">
    <meta name="apple-mobile-web-app-title" content="Gluu Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../gluu.jpg">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-60feabe0e5.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-60feabe0e5.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-f58e216493.css">
    
    <link rel="stylesheet" href="../../assets/stylesheets/zenburn-28d5b94970.css">
    
      
      
      
      <link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Sans:400,700|Source+Code+Pro">
      <style>
        body, input {
          font-family: 'Noto Sans', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Source Code Pro', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../../assets/javascripts/modernizr-4a5cc7e01e.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Administration Guide <i class="icon icon-link"></i>
              
            
          </span>
        
        6. UMA
      </div>
    </div>
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" placeholder="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">

  
  <a href="https://github.com/GluuFederation/docs" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../gluu.jpg">
        </div>
      
      <div class="name">
        <strong>Gluu Docs</strong><br>
        version: 2.4.4
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      <ul class="repo">
        
        <li class="home">
          <a href="/" title="Home">
            <div class="home-image">
            <i class="fa fa-home"></i> Doc Home</div>
          </a>
        </li>
        
        
        
        <li class="repo-download">
          
          <a href="https://github.com/GluuFederation/docs/archive/2.4.4.zip" target="_blank" title="Download" data-action="download">
            <i class="icon icon-download"></i> Download
          </a>
        </li>
        
      </ul>
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>
                  
          
            
  <li>
    <span class="section">Installation Guide</span>
    <ul>
      
        
  <li>
    <span class="section">Single Setup</span>
    <ul>
      
        
  <li>
    <a class="" title="1 Preparing VM" href="../../installation-guide/">
      1 Preparing VM
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="2 Install Gluu Server" href="../../installation-guide/install/">
      2 Install Gluu Server
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="2.5 Setup Script Options" href="../../installation-guide/setup_py/">
      2.5 Setup Script Options
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
      
        
  <li>
    <span class="section">Cluster Setup</span>
    <ul>
      
        
  <li>
    <a class="" title="3 Cluster Deployment Guide" href="../../cluster/">
      3 Cluster Deployment Guide
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
      
        
  <li>
    <span class="section">Upgrade Gluu Server</span>
    <ul>
      
        
  <li>
    <a class="" title="4 Upgrade Guide" href="../../upgrade/">
      4 Upgrade Guide
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
      
    </ul>
  </li>
                  
          
            
  <li>
    <a class="" title="oxTrust Admin Interface" href="../../oxtrust/">
      oxTrust Admin Interface
    </a>
    
  </li>
                  
          
            
  <li>
    <span class="section">Administration Guide</span>
    <ul>
      
        
  <li>
    <a class="" title="1. Introduction" href="../">
      1. Introduction
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="2. SAML" href="../authentication-protocol-saml/">
      2. SAML
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="3 Test SAML" href="../authentication-protocol-saml-test/">
      3 Test SAML
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="4. OpenID Connect" href="../authentication-protocol-openid/">
      4. OpenID Connect
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="5. Test OpenID" href="../authentication-protocol-openid-test/">
      5. Test OpenID
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="current" title="6. UMA" href="./">
      6. UMA
    </a>
    
      
      
        <ul>
          
            <li class="anchor">
              <a title="6.1 Resource Registration" href="#61-resource-registration">
                <b>6.1 Resource Registration</b>
              </a>
            </li>
            
          
            <li class="anchor">
              <a title="6.2 Scopes" href="#62-scopes">
                <b>6.2 Scopes</b>
              </a>
            </li>
            
              <li class="anchor">
              <a title="6.2.1 Add Scope" href="#621-add-scope">
                  <font size=2><i>6.2.1 Add Scope</i></font>
              </a>
            </li>
             
          
            <li class="anchor">
              <a title="6.3 UMA Policies" href="#63-uma-policies">
                <b>6.3 UMA Policies</b>
              </a>
            </li>
            
              <li class="anchor">
              <a title="6.3.1 UMA Policy Algorithm" href="#631-uma-policy-algorithm">
                  <font size=2><i>6.3.1 UMA Policy Algorithm</i></font>
              </a>
            </li>
             
          
        </ul>
      
    
  </li>
                  
      
        
  <li>
    <a class="" title="7. SCIM" href="../scim/">
      7. SCIM
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
          
            
  <li>
    <span class="section">Reference Guide</span>
    <ul>
      
        
  <li>
    <a class="" title="1. 'Introduction'" href="../../reference-guide/">
      1. 'Introduction'
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
            <h1>6. UMA</h1>
          
          <p>This section describes the adminisration of UMA in Gluu Server CE. The UMA administration is accessible from the oxTrust administrator interface.</p>
<p><img alt="menu" src="../../img/uma/menu.png" /></p>
<h2 id="61-resource-registration">6.1 Resource Registration<a class="headerlink" href="#61-resource-registration" title="Permanent link">#</a></h2>
<p>The resources protected by UMA must be registered in oxTrust. The following propterties describe a resource:</p>
<ul>
<li>name</li>
<li>scopes</li>
<li>type</li>
<li>icon_uri</li>
</ul>
<p>The resource type can be a string, URI or any other supported value type supported by Gluu Server CE. The properties shown above are not concrete, and it is possible that a resource may contain custom properties. An example of the resource JSON is given beow:</p>
<pre><code>{
&quot;name&quot;:&quot;scim_access&quot;,
&quot;icon_uri&quot;:&quot;https:\/\/centos.gluu.info\/identity\/uma\/scope\/file\/scim_access&quot;
}
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Resource JSON may contain custom properties.</p>
</div>
<p><img alt="uma-resources" src="../../img/uma/uma-resources.png" /></p>
<p>The search bar can be used to search for any existing resource within Gluu Server. New resoruces can be added by clicking on the <code>Add Resource Set</code> button. The following screenshot shows the page that will appear up on clicking the add resource button.</p>
<p><img alt="add-resource-set" src="../../img/uma/add-resource-set.png" /></p>
<p>The properties of a resource is visible in this page. There are two additional buttons that allows the administrator to add specific resource or scope as well. By default, Gluu Server is shipped with SCIM resources protected by UMA.</p>
<p><img alt="add-resource" src="../../img/uma/add-resource.png" /></p>
<p><img alt="add-scope" src="../../img/uma/add-scope.png" /></p>
<h2 id="62-scopes">6.2 Scopes<a class="headerlink" href="#62-scopes" title="Permanent link">#</a></h2>
<p>The scopes in UMA are bount to resource sets and used by policies to check whether the specified user has access to the resource. The scopes are described in JSON and has the following properties:</p>
<ul>
<li>name</li>
<li>icon_uri</li>
</ul>
<p>An example  of the scope JSON is given below:</p>
<pre><code>{
  &quot;name&quot;: &quot;Add photo&quot;,
  &quot;icon_uri&quot;: &quot;http://www.gluu.org/icons/add_photo_scope.png&quot;
}
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scope JSON may contain custom properties.</p>
</div>
<p>There are three (3) types of scopes in UMA:</p>
<ol>
<li><code>internal</code>: the scope is hosted within oxAuth in Gluu Server CE</li>
<li><code>external</code>: the scope is hosted in a different server</li>
<li><code>external_auto</code>: the scope is hosted in a different server, but it is added to Gluu Server CE during the resource registration</li>
</ol>
<p>There is no URI for an internal scope because it sits within oxAuth in the Gluu Server. The UMA URL is represented in the format</p>
<pre><code>UMA URL=uma_scopes_endpoint+&quot;/&quot;+oxId;
</code></pre>

<p>The following is an example of an UMA URL:</p>
<pre><code>https://gluu.org/uma/scopes/view
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The scope endpoint has to be present in UMA configuration to make it discoverable.</p>
</div>
<p>The <code>ldif</code> for both external and internal scope is given below:</p>
<p><strong>External sample ldif</strong></p>
<pre><code>dn: inum=@!1111!8990!BF80,ou=scopes,ou=uma,o=@!1111,o=gluu
displayName: View
inum: @!1111!8990!BF80
objectClass: oxAuthUmaScopeDescription
objectClass: top
oxType: external
oxUrl: http://photoz.example.com/dev/scopes/view
</code></pre>

<p><strong>Internal sample ldif</strong></p>
<pre><code>dn: inum=@!1111!8990!BF80,ou=scopes,ou=uma,o=@!1111,o=gluu
displayName: View
inum: @!1111!8990!BF80
objectClass: oxAuthUmaScopeDescription
objectClass: top
oxType: internal
oxId: View
oxIconUrl: http://seed.gluu.org/uma/icons/view_scope.png
</code></pre>

<h3 id="621-add-scope">6.2.1 Add Scope<a class="headerlink" href="#621-add-scope" title="Permanent link">#</a></h3>
<p>This section defines the process of defining UMA scopes from oxTrust. The scopes are accessed from the <code>Scopes</code> page under <code>UMA</code> from the oxTrust menu.</p>
<p><img alt="uma-scopes" src="../../img/uma/uma-scopes.png" /></p>
<p>The search bar can be used to look for available scopes. New scopes are added by clicking on the <code>Add Scope Description</code> button which will bring up the interface shown below.</p>
<p><img alt="uma-scopes" src="../../img/uma/scopes-add.png" /></p>
<p>Additionally there is an option to add authorization policy with the new scope.</p>
<h2 id="63-uma-policies">6.3 UMA Policies<a class="headerlink" href="#63-uma-policies" title="Permanent link">#</a></h2>
<p>UMA policies protect UMA Resources via scopes. Gluu Server evaluates all policies, identified by scopes, to grant access to resources. There are three (3) main properties of a policy:</p>
<ol>
<li>scopes: policy protects resources by scopes</li>
<li>authorization script: script that is evaluated in order to grant/deny access</li>
<li>name: a human readable name to the UMA policy</li>
</ol>
<p>The following section outlines how to define UMA policies from the Custom Script menu. The Custom Script page is accessed from the Configuration Menu.</p>
<p><img alt="custom-script-menu" src="../../img/oxtrust/custom-script-menu.png" />
<img alt="auth-policy" src="../../img/uma/auth-policy.png" /></p>
<h3 id="631-uma-policy-algorithm">6.3.1 UMA Policy Algorithm<a class="headerlink" href="#631-uma-policy-algorithm" title="Permanent link">#</a></h3>
<p>The UMA Policy alrorithm has two rules that are followed. These rules must be followed while writing UMA policy using the custom script feature of Gluu Server.</p>
<ul>
<li>
<p>UMA Policy protects resources based on scopes. If a scope is protected by a policy, then the policy script must reutrn <code>true</code> in order to authorize access during RPT authorization.</p>
</li>
<li>
<p>Multiple policies can protect a single scope. In such a case, all the policies must retun <code>true</code> to authorize access else aceess will be denied.</p>
</li>
</ul>
<p><img alt="policy-algorithm" src="../../img/uma/policy-algorithm.jpg" /> </p>
          <aside class="copyright" role="note">
           Built with 
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a> using
            <a href="http://gitlab.testbird.io:8099/frontend/testbird-mkdocs-theme.git" target="_blank">
              testBird-mkdocs-theme
            </a> <br>
            
            Copyright &copy; 2016, Gluu, Inc.
            
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../authentication-protocol-openid-test/" title="5. Test OpenID">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                5. Test OpenID
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../scim/" title="7. SCIM">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                7. SCIM
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = '';
    </script>
    <script src="../../assets/javascripts/application-ce3999cf34.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
      <script src="../../dist/clipboard.js"></script>
    
      <script src="../../dist/clipboard.min.js"></script>
    
    
  </body>
</html>